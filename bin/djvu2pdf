
bakdir="/Users/gordanz/Desktop"

d2p() {
    filename="${1%%.*}"
    extension="${1##*.}"
    if [ $extension != "djvu" ]; then
        echo "Extension of $1 is not .djvu. Skipping."
    else
        echo "Converting $filename.djvu to $filename.pdf"
        ddjvu -format=pdf -mode=black -quality=100 $filename.djvu $filename.pdf
        if command -v gchmod &> /dev/null
        then
            echo "Copying permissions"
            gchmod --reference=$filename.djvu $filename.pdf
        fi
        # if gchmod does not exist, install the coreutils (gnu) version:
        # brew install coreutils
        mv $filename.djvu $bakdir
        echo "Original $filename.djvu moved to $bakdir"
    fi
}
 
for name in "$@"
do
    d2p "$name"
done